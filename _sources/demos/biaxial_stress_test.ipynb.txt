{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {
    "lines_to_next_cell": 2
   },
   "source": [
    "# Biaxial stress test\n",
    "\n",
    "Attempt to reproduce Figure 8 in [1].\n",
    "\n",
    "\n",
    "> [1] Holzapfel, Gerhard A., and Ray W. Ogden.\n",
    "    \"Constitutive modelling of passive myocardium:\n",
    "    a structurally based framework for material characterization.\n",
    "    \"Philosophical Transactions of the Royal Society of London A:\n",
    "    Mathematical, Physical and Engineering Sciences 367.1902 (2009): 3445-3475.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [],
   "source": [
    "import dolfin\n",
    "import matplotlib.pyplot as plt\n",
    "import numpy as np\n",
    "\n",
    "try:\n",
    "    from dolfin_adjoint import (\n",
    "        Constant,\n",
    "        DirichletBC,\n",
    "        Expression,\n",
    "        UnitCubeMesh,\n",
    "        interpolate,\n",
    "    )\n",
    "except ImportError:\n",
    "    from dolfin import (\n",
    "        Constant,\n",
    "        DirichletBC,\n",
    "        interpolate,\n",
    "        Expression,\n",
    "        UnitCubeMesh,\n",
    "    )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pulse"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Create mesh\n",
    "N = 2\n",
    "mesh = UnitCubeMesh(N, N, N)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Create a facet fuction in order to mark the subdomains\n",
    "ffun = dolfin.MeshFunction(\"size_t\", mesh, 2)\n",
    "ffun.set_all(0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Mark subdomains\n",
    "xlow = dolfin.CompiledSubDomain(\"near(x[0], 0) && on_boundary\")\n",
    "xlow_marker = 1\n",
    "xlow.mark(ffun, xlow_marker)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [],
   "source": [
    "xhigh = dolfin.CompiledSubDomain(\"near(x[0], 1.0) && on_boundary\")\n",
    "xhigh_marker = 2\n",
    "xhigh.mark(ffun, xhigh_marker)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [],
   "source": [
    "ylow = dolfin.CompiledSubDomain(\"near(x[0], 0) && on_boundary\")\n",
    "ylow_marker = 3\n",
    "ylow.mark(ffun, ylow_marker)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "yhigh = dolfin.CompiledSubDomain(\"near(x[1], 1) && on_boundary\")\n",
    "yhigh_marker = 4\n",
    "yhigh.mark(ffun, yhigh_marker)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Collect the functions containing the markers\n",
    "marker_functions = pulse.MarkerFunctions(ffun=ffun)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Create mictrotructure\n",
    "V_f = pulse.QuadratureSpace(mesh, 4)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Fibers\n",
    "f0 = interpolate(Expression((\"1.0\", \"0.0\", \"0.0\"), degree=1), V_f)\n",
    "# Sheets\n",
    "s0 = interpolate(Expression((\"0.0\", \"1.0\", \"0.0\"), degree=1), V_f)\n",
    "# Fiber-sheet normal\n",
    "n0 = interpolate(Expression((\"0.0\", \"0.0\", \"1.0\"), degree=1), V_f)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Collect the mictrotructure\n",
    "microstructure = pulse.Microstructure(f0=f0, s0=s0, n0=n0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Create the geometry\n",
    "geometry = pulse.Geometry(\n",
    "    mesh=mesh,\n",
    "    marker_functions=marker_functions,\n",
    "    microstructure=microstructure,\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Use the default material parameters\n",
    "material_parameters = {\n",
    "    \"a\": 2.28,\n",
    "    \"b\": 9.726,\n",
    "    \"a_f\": 1.685,\n",
    "    \"b_f\": 15.779,\n",
    "    \"a_s\": 0,\n",
    "    \"a_fs\": 0,\n",
    "}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {
    "lines_to_next_cell": 2
   },
   "outputs": [],
   "source": [
    "# Create material\n",
    "material = pulse.HolzapfelOgden(parameters=material_parameters)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Eff / Ess strain ratio\n",
    "strain_ratio = Constant(1.0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Create costants defined for the dirichlet BC\n",
    "u0 = Constant(0.0)\n",
    "x_strain = u0 * strain_ratio / 2\n",
    "y_strain = u0 * (1 / strain_ratio) / 2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Make Dirichlet boundary conditions\n",
    "def dirichlet_bc(W):\n",
    "    V = W if W.sub(0).num_sub_spaces() == 0 else W.sub(0)\n",
    "    return [\n",
    "        DirichletBC(V.sub(0), Constant(-x_strain), xlow),\n",
    "        DirichletBC(V.sub(0), Constant(x_strain), xhigh),\n",
    "        DirichletBC(V.sub(1), Constant(-y_strain), ylow),\n",
    "        DirichletBC(V.sub(1), Constant(y_strain), yhigh),\n",
    "    ]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Collect Boundary Conditions\n",
    "bcs = pulse.BoundaryConditions(dirichlet=(dirichlet_bc,))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Create problem\n",
    "problem = pulse.MechanicsProblem(geometry, material, bcs)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2021-05-11 09:56:18,224 - pulse.iterate - INFO - Iterating....\n",
      "2021-05-11 09:56:18,225 - pulse.iterate - INFO - Current control: 0.000\n",
      "2021-05-11 09:56:18,226 - pulse.iterate - INFO - Target: 0.000\n",
      "2021-05-11 09:56:18,246 - pulse.iterate - INFO - Iterating....\n",
      "2021-05-11 09:56:18,247 - pulse.iterate - INFO - Current control: 0.000\n",
      "2021-05-11 09:56:18,248 - pulse.iterate - INFO - Target: 0.011\n",
      "2021-05-11 09:56:18,594 - pulse.iterate - INFO - Iterating....\n",
      "2021-05-11 09:56:18,595 - pulse.iterate - INFO - Current control: 0.011\n",
      "2021-05-11 09:56:18,596 - pulse.iterate - INFO - Target: 0.022\n",
      "2021-05-11 09:56:21,158 - pulse.iterate - INFO - Iterating....\n",
      "2021-05-11 09:56:21,159 - pulse.iterate - INFO - Current control: 0.022\n",
      "2021-05-11 09:56:21,159 - pulse.iterate - INFO - Target: 0.033\n",
      "2021-05-11 09:56:21,491 - pulse.iterate - INFO - Iterating....\n",
      "2021-05-11 09:56:21,492 - pulse.iterate - INFO - Current control: 0.033\n",
      "2021-05-11 09:56:21,493 - pulse.iterate - INFO - Target: 0.044\n",
      "2021-05-11 09:56:22,952 - pulse.iterate - INFO - Iterating....\n",
      "2021-05-11 09:56:22,953 - pulse.iterate - INFO - Current control: 0.044\n",
      "2021-05-11 09:56:22,954 - pulse.iterate - INFO - Target: 0.056\n",
      "2021-05-11 09:56:23,319 - pulse.iterate - INFO - Iterating....\n",
      "2021-05-11 09:56:23,320 - pulse.iterate - INFO - Current control: 0.056\n",
      "2021-05-11 09:56:23,321 - pulse.iterate - INFO - Target: 0.067\n",
      "2021-05-11 09:56:24,955 - pulse.iterate - INFO - Iterating....\n",
      "2021-05-11 09:56:24,956 - pulse.iterate - INFO - Current control: 0.067\n",
      "2021-05-11 09:56:24,956 - pulse.iterate - INFO - Target: 0.078\n",
      "2021-05-11 09:56:25,374 - pulse.iterate - INFO - Iterating....\n",
      "2021-05-11 09:56:25,374 - pulse.iterate - INFO - Current control: 0.078\n",
      "2021-05-11 09:56:25,375 - pulse.iterate - INFO - Target: 0.089\n",
      "2021-05-11 09:56:25,807 - pulse.iterate - INFO - Iterating....\n",
      "2021-05-11 09:56:25,808 - pulse.iterate - INFO - Current control: 0.089\n",
      "2021-05-11 09:56:25,808 - pulse.iterate - INFO - Target: 0.100\n",
      "2021-05-11 09:56:26,249 - pulse.iterate - INFO - Iterating....\n",
      "2021-05-11 09:56:26,250 - pulse.iterate - INFO - Current control: 0.100\n",
      "2021-05-11 09:56:26,251 - pulse.iterate - INFO - Target: 0.000\n"
     ]
    },
    {
     "ename": "SolverDidNotConverge",
     "evalue": "",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mSolverDidNotConverge\u001b[0m                      Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-44-66b06ae58ab6>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m     10\u001b[0m     \u001b[0mSsss\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     11\u001b[0m     \u001b[0;32mfor\u001b[0m \u001b[0mxi\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mlinspace\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;36m0.1\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;36m10\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 12\u001b[0;31m         \u001b[0mpulse\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0miterate\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0miterate\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mproblem\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mu0\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mConstant\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mxi\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mreinit_each_step\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mTrue\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     13\u001b[0m         \u001b[0mS\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mproblem\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mSecondPiolaStress\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     14\u001b[0m         \u001b[0mE\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mproblem\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mGreenLagrangeStrain\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/local/src/pulse/pulse/iterate.py\u001b[0m in \u001b[0;36miterate\u001b[0;34m(problem, control, target, continuation, max_adapt_iter, adapt_step, old_states, old_controls, max_nr_crash, max_iters, initial_number_of_steps, reinit_each_step)\u001b[0m\n\u001b[1;32m    326\u001b[0m         \u001b[0mreinit_each_step\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mreinit_each_step\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    327\u001b[0m     ) as iterator:\n\u001b[0;32m--> 328\u001b[0;31m         \u001b[0mres\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0miterator\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msolve\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    329\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    330\u001b[0m     \u001b[0;32mreturn\u001b[0m \u001b[0mres\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/local/src/pulse/pulse/iterate.py\u001b[0m in \u001b[0;36msolve\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m    422\u001b[0m                 \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0massign_control\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0menlist\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcontrol_values\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    423\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 424\u001b[0;31m                 \u001b[0;32mraise\u001b[0m \u001b[0mSolverDidNotConverge\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    425\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    426\u001b[0m             \u001b[0mprev_state\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mprev_states\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m-\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mSolverDidNotConverge\u001b[0m: "
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Solve problem\n",
    "fig, ax = plt.subplots(1, 2)\n",
    "u0s = [0.045, 0.6, 0.8]\n",
    "markers = [\"^\", \"s\", \"o\"]\n",
    "for i, sr in enumerate([2.05, 1.02, 0.48]):\n",
    "    strain_ratio.assign(sr)\n",
    "    Effs = []\n",
    "    Sffs = []\n",
    "    Esss = []\n",
    "    Ssss = []\n",
    "    for xi in np.linspace(0, 0.1, 10):\n",
    "        pulse.iterate.iterate(problem, u0, Constant(xi), reinit_each_step=True)\n",
    "        S = problem.SecondPiolaStress()\n",
    "        E = problem.GreenLagrangeStrain()\n",
    "\n",
    "        Sff = dolfin.assemble(dolfin.inner(f0, S * f0) * dolfin.dx)\n",
    "        Eff = dolfin.assemble(dolfin.inner(f0, E * f0) * dolfin.dx)\n",
    "\n",
    "        Effs.append(Eff)\n",
    "        Sffs.append(Sff)\n",
    "\n",
    "        Sss = dolfin.assemble(dolfin.inner(s0, S * s0) * dolfin.dx)\n",
    "        Ess = dolfin.assemble(dolfin.inner(s0, E * s0) * dolfin.dx)\n",
    "\n",
    "        Esss.append(Ess)\n",
    "        Ssss.append(Sss)\n",
    "\n",
    "    ax[0].plot(Effs, Sffs, marker=markers[i], label=f\"SR: {sr:.2f}\")\n",
    "    ax[1].plot(Esss, Ssss, marker=markers[i], label=f\"SR: {sr:.2f}\")\n",
    "ax[0].set_ylabel(\"$S_{ff}$ (kPa)\")\n",
    "ax[1].set_ylabel(\"$S_{ss}$ (kPa)\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "ax[0].set_xlabel(\"$E_{ff}$\")\n",
    "ax[1].set_xlabel(\"$E_{ss}$\")\n",
    "for axi in ax:\n",
    "    axi.legend()\n",
    "fig.savefig(\"biaxial_test\")"
   ]
  }
 ],
 "metadata": {
  "jupytext": {
   "cell_metadata_filter": "-all",
   "main_language": "python",
   "notebook_metadata_filter": "-all"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
